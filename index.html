<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Learning App</title>

<style>
body {
  font-family: Arial, sans-serif;
  max-width: 720px;
  margin: auto;
  padding: 16px;
}

input, textarea, select, button {
  width: 100%;
  margin: 6px 0;
  padding: 8px;
  font-size: 15px;
}

button { cursor: pointer; }

.row {
  display: flex;
  gap: 6px;
}
.row button { flex: 1; }

.card {
  border: 1px solid #ccc;
  padding: 12px;
  border-radius: 6px;
  margin-top: 10px;
}

.en {
  color: #0077cc;
  margin-top: 8px;
  font-weight: bold;
}

.hidden { display: none; }
</style>
</head>

<body>

<h2>ğŸ“˜ English Learning App</h2>

<div class="row">
  <button onclick="startStudy()">ğŸ¯ Báº¯t Ä‘áº§u há»c</button>
  <button onclick="stopStudy()">ğŸ“‚ Vá» danh sÃ¡ch</button>
</div>

<hr>

<!-- ================= STUDY MODE ================= -->
<div id="studyBox" class="card hidden">
  <h3>ğŸ§ Study Mode</h3>

  <div id="studyVi"></div>
  <div id="studyEn" class="en hidden"></div>

  <div class="row">
    <button onclick="speakCurrent()">ğŸ”Š Nghe</button>
    <button onclick="toggleStudyEn()">ğŸ‘ Hiá»‡n / áº¨n EN</button>
  </div>

  <button onclick="nextSentence()">â¡ï¸ CÃ¢u tiáº¿p theo</button>
</div>

<!-- ================= DONE ================= -->
<div id="doneBox" class="card hidden">
  <h3>ğŸ‰ Báº¡n Ä‘Ã£ há»c xong!</h3>
  <button onclick="startStudy()">ğŸ” Há»c láº¡i tá»« Ä‘áº§u</button>
</div>

<hr>

<!-- ================= LIST MODE ================= -->
<div id="listMode">
  <h3>ğŸ“‚ Danh sÃ¡ch cÃ¢u</h3>
  <div id="list"></div>
</div>

<script>
/* ===== STORAGE ===== */
const KEY = "english_sentences";

/* ===== STUDY STATE ===== */
let studyQueue = [];
let current = null;

/* ===== DATA ===== */
function getData() {
  return JSON.parse(localStorage.getItem(KEY)) || [];
}

/* ===== STUDY MODE ===== */
function startStudy() {
  const data = getData();
  if (!data.length) {
    alert("ChÆ°a cÃ³ cÃ¢u nÃ o");
    return;
  }

  studyQueue = shuffle([...data]);
  document.getElementById("listMode").classList.add("hidden");
  document.getElementById("doneBox").classList.add("hidden");
  document.getElementById("studyBox").classList.remove("hidden");

  nextSentence();
}

function stopStudy() {
  document.getElementById("studyBox").classList.add("hidden");
  document.getElementById("doneBox").classList.add("hidden");
  document.getElementById("listMode").classList.remove("hidden");
}

function nextSentence() {
  if (!studyQueue.length) {
    document.getElementById("studyBox").classList.add("hidden");
    document.getElementById("doneBox").classList.remove("hidden");
    return;
  }

  current = studyQueue.pop();
  studyVi.innerText = "ğŸ‡»ğŸ‡³ " + current.vi;
  studyEn.innerText = "ğŸ‡¬ğŸ‡§ " + current.en;
  studyEn.classList.add("hidden");
}

function toggleStudyEn() {
  studyEn.classList.toggle("hidden");
}

function speakCurrent() {
  if (!current) return;
  const u = new SpeechSynthesisUtterance(current.en);
  u.lang = "en-US";
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}

/* ===== LIST MODE (ÄÆ N GIáº¢N) ===== */
function renderList() {
  const list = document.getElementById("list");
  list.innerHTML = "";
  getData().forEach(s => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<b>${s.vi}</b><br>${s.en}`;
    list.appendChild(div);
  });
}

/* ===== UTILS ===== */
function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* ===== INIT SAMPLE DATA (XOÃ SAU) ===== */
if (!localStorage.getItem(KEY)) {
  localStorage.setItem(KEY, JSON.stringify([
    { vi: "CÃ³ má»™t cÃ¡i bÃ n", en: "There is a table." },
    { vi: "CÃ³ hai cÃ¡i gháº¿", en: "There are two chairs." },
    { vi: "TÃ´i Ä‘ang há»c tiáº¿ng Anh", en: "I am learning English." }
  ]));
}

renderList();
</script>

</body>
</html>
